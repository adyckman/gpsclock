"""Precomputed US timezone boundary grid at 0.25-degree resolution.

Auto-generated by utils/gen_tz_grid.py -- do not edit manually.
"""

LAT_MIN = 24.0
LAT_MAX = 50.0
LON_MIN = -125.0
STEP = 0.25
ROWS = 104

# Arizona bounds (Mountain Standard Time, no DST)
AZ_LAT_S = 31.33
AZ_LAT_N = 37.0
AZ_LON_W = -114.82
AZ_LON_E = -109.04

# Boundary data: 3 bytes per latitude row
# [Pacific/Mountain, Mountain/Central, Central/Eastern]
# Each byte = longitude offset from LON_MIN in STEP-degree units
_B = (
    b'\x00\x00\xae\x00\x00\xae\x00\x00\xae\x00\x00\xae\x00\x00\xa0'
    b'\x00\x00\xa0\x00\x00\xa0\x00\x00\xa0\x00\x00\xa0\x00\x00\xa0'
    b'\x00\x00\xa0\x00\x00\xa0\x00\x00\xa0\x00\x00\xa0\x00\x00\xa0'
    b'\x00\x00\xa0\x00\x00\xa0\x00\x00\xa0\x00\x00\xa0\x00\x00\xa0'
    b'\x00\x00\xa0\x00\x00\xa0\x00\x00\x9e\x00\x00\x9e\x00\x00\x9e'
    b'\x00\x00\x9e\x00\x52\x9e\x00\x52\x9e\x00\x52\xa0\x00\x52\xa0'
    b'\x00\x52\xa0\x00\x52\xa0\x00\x58\xa0\x00\x58\xa0\x2a\x58\xa0'
    b'\x2a\x58\xa0\x2a\x58\xa0\x2a\x58\xa0\x2a\x58\xa0\x2a\x58\xa0'
    b'\x2a\x58\xa0\x2a\x58\xa0\x2a\x58\xa0\x2a\x58\xa0\x2a\x58\x9f'
    b'\x2a\x58\x9f\x2a\x58\x9f\x2a\x58\x9f\x2c\x58\x9f\x2c\x58\x9f'
    b'\x2c\x58\x9f\x2c\x58\x9f\x2c\x5c\x9c\x2c\x5c\x9c\x2c\x5c\x9c'
    b'\x2c\x5c\x9c\x2c\x5c\x9c\x2c\x5c\x9c\x2c\x5c\x9a\x2c\x5c\x9a'
    b'\x2c\x5c\x9a\x2c\x5c\x9a\x2c\x5c\x96\x2c\x5c\x96\x2c\x5c\x96'
    b'\x2c\x5c\x96\x2c\x5c\x96\x2c\x5c\x96\x2c\x54\x96\x2c\x54\x96'
    b'\x2c\x54\x96\x2c\x54\x96\x21\x54\x96\x21\x54\x96\x21\x54\x96'
    b'\x21\x54\x96\x21\x54\x96\x21\x54\x96\x21\x54\x96\x21\x54\x96'
    b'\x21\x54\x96\x21\x54\x96\x21\x54\x96\x21\x54\x96\x21\x54\x96'
    b'\x21\x54\x96\x21\x54\x94\x21\x54\x94\x20\x54\x94\x20\x54\x94'
    b'\x20\x54\x94\x20\x54\x94\x20\x54\x94\x20\x54\x94\x20\x54\x90'
    b'\x20\x54\x90\x20\x54\x90\x20\x54\x90\x20\x54\x90\x20\x54\x90'
    b'\x20\x54\x90\x20\x54\x90\x20\x54\x90\x20\x54\x90'
)


def lookup(lat, lon):
    """Look up timezone index from GPS coordinates.

    Returns index into timezone._ZONES (0-6), or -1 if outside grid.
    0=Eastern 1=Central 2=Mountain 3=Arizona 4=Pacific 5=Alaska 6=Hawaii
    """
    if lat > 54.0 and lon < -130.0:
        return 5
    if lat < 23.5 and lon < -154.0:
        return 6
    if lat < LAT_MIN or lat >= LAT_MAX or lon < LON_MIN or lon > -66.5:
        return -1
    row = int((lat - LAT_MIN) / STEP)
    if row >= ROWS:
        row = ROWS - 1
    col = (lon - LON_MIN) / STEP
    i = row * 3
    if col < _B[i]:
        return 4
    if col < _B[i + 1]:
        if AZ_LAT_S <= lat <= AZ_LAT_N and AZ_LON_W <= lon <= AZ_LON_E:
            return 3
        return 2
    if col < _B[i + 2]:
        return 1
    return 0
